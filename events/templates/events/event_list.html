{% extends "model/base.html" %}
{% block content %}

<style>
  body {
    background-image: linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)), url("/static/model/images/party3.jpg");
    background-size: cover;
    background-position: center;
    background-repeat: no-repeat;
    background-attachment: fixed;
    min-height: 100vh;
  }
  
  .glass-card {
    background-color: rgba(255, 255, 255, 0.9);
    border: 1px solid rgba(255, 255, 255, 0.3);
    transition: transform 0.2s ease, box-shadow 0.2s ease;
  }
  
  .glass-card:hover {
    transform: translateY(-3px);
    box-shadow: 0 8px 25px rgba(0,0,0,0.15);
  }
  
  .compact-card {
    height: 300px; 
    overflow: hidden;
  }
  
  .compact-image {
    height: 140px !important;
    object-fit: cover;
  }
  
  .compact-body {
    padding: 0.8rem; 
  }
  
  .event-title {
    font-size: 1rem; 
    font-weight: 600;
    margin-bottom: 0.3rem; 
    line-height: 1.2;
    height: 2.2rem; 
    overflow: hidden;
  }
  
  .event-description {
    font-size: 0.85rem; 
    color: #666;
    line-height: 1.3;
    height: 2.2rem; 
    overflow: hidden;
    margin-bottom: 0.5rem; 
  }
  
  .event-meta {
    font-size: 0.75rem; 
    color: #888;
    line-height: 1.2;
    margin-bottom: 0.8rem; 
  }
  
  .event-meta div {
    margin-bottom: 0.1rem; 
  }
  
  .btn-sm {
    padding: 0.25rem 0.5rem;
    font-size: 0.8rem;
  }

  /* Mobile responsive improvements */
  @media (max-width: 768px) {
    .compact-card {
      height: auto;
      min-height: 280px;
    }
    
    .compact-image {
      height: 120px !important;
    }
    
    .event-title {
      font-size: 0.95rem;
      height: 2.4rem;
    }
    
    .event-description {
      font-size: 0.8rem;
      height: 2.4rem;
    }
    
    .event-meta {
      font-size: 0.8rem;
    }
    
    .btn-sm {
      padding: 0.4rem 0.8rem;
      font-size: 0.85rem;
    }
    
    .page-header {
      flex-direction: column;
      gap: 1rem;
      text-align: center;
    }
    
    .page-header h2 {
      font-size: 1.5rem;
    }
    
    .filter-sidebar {
      margin-bottom: 2rem;
      position: static !important;
    }
  }
  
  @media (max-width: 576px) {
    .compact-card {
      min-height: 260px;
    }
    
    .compact-image {
      height: 100px !important;
    }
    
    .event-title {
      font-size: 0.9rem;
      height: 2.6rem;
    }
    
    .event-description {
      font-size: 0.75rem;
      height: 2.6rem;
    }
    
    .event-meta div {
      margin-bottom: 0.2rem;
    }
    
    .btn-sm {
      padding: 0.5rem 1rem;
      font-size: 0.9rem;
    }
    
    .card-body {
      padding: 1rem;
    }
  }
</style>

<div class="row">
  <!-- Filters Sidebar -->
  <div class="col-12 col-md-3">
    <div class="card glass-card filter-sidebar">
      <div class="card-header">
        <h5 class="mb-0">üîç Filters</h5>
      </div>
      <div class="card-body">
        <form method="get">
          <div class="mb-3">
            <label class="form-label">Search</label>
            <input type="text" name="search" class="form-control" value="{{ request.GET.search }}" placeholder="Search events...">
          </div>
          <div class="mb-3">
            <label class="form-label">Category</label>
            <select name="category" class="form-select">
              <option value="">All Categories</option>
              {% for category in categories %}
                <option value="{{ category.id }}" {% if request.GET.category == category.id|stringformat:"i" %}selected{% endif %}>
                  {{ category.name }}
                </option>
              {% endfor %}
            </select>
          </div>
          <button type="submit" class="btn btn-primary w-100">Apply Filters</button>
          <a href="{% url 'event-list' %}" class="btn btn-secondary w-100 mt-2">Clear</a>
        </form>
      </div>
    </div>
  </div>
  
  <!-- Events Content -->
  <div class="col-12 col-md-9">
    <div class="d-flex justify-content-between align-items-center mb-4 page-header">
      <h2 style="color: white; text-shadow: 2px 2px 4px rgba(0,0,0,0.5); font-weight: bold;">üé™ All Events</h2>
      <a href="{% url 'event-add' %}" class="btn btn-success">‚ûï Create Event</a>
    </div>
    
    <div class="row">
      {% for event in events %}
        <div class="col-12 col-sm-6 col-lg-4 mb-4">
          <div class="card h-100 glass-card compact-card">
            {% if event.image %}
              <img src="{{ event.image.url }}" class="card-img-top compact-image" alt="{{ event.title }}" loading="lazy">
            {% else %}
              <div class="card-img-top compact-image bg-light d-flex align-items-center justify-content-center">
                <span class="text-muted" style="font-size: 0.8rem;">üì∑ No Image</span>
              </div>
            {% endif %}
            <div class="card-body compact-body">
              <h6 class="event-title">{{ event.title|truncatewords:5 }}</h6>
              <p class="event-description">{{ event.description|truncatewords:8 }}</p>
              
              <div class="event-meta">
                <div><strong>üìÖ</strong> {{ event.date|date:"M d" }}</div>
                <div><strong>üìç</strong> {{ event.location|truncatechars:18 }}</div>
                <div><strong>üë•</strong> {{ event.spots_available }} spots</div>
              </div>
              
              <a href="{% url 'event-detail' event.pk %}" class="btn btn-primary btn-sm w-100">View Details</a>
            </div>
          </div>
        </div>
      {% empty %}
        <div class="col-12">
          <div class="alert alert-info glass-card text-center">
            <h5>No events found</h5>
            <p class="mb-2">No events match your search criteria.</p>
            <a href="{% url 'event-add' %}" class="btn btn-success">Create the first event!</a>
          </div>
        </div>
      {% endfor %}
    </div>
  </div>
</div>
{% endblock %}